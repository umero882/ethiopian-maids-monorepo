<!DOCTYPE html>
<html>
<head>
    <title>Firebase Login Test</title>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
    <style>
        body { font-family: Arial, sans-serif; max-width: 500px; margin: 50px auto; padding: 20px; }
        input { width: 100%; padding: 10px; margin: 10px 0; box-sizing: border-box; }
        button { width: 100%; padding: 12px; background: #4CAF50; color: white; border: none; cursor: pointer; margin: 5px 0; }
        button:hover { background: #45a049; }
        button.secondary { background: #2196F3; }
        button.danger { background: #f44336; }
        #result { margin-top: 20px; padding: 15px; border-radius: 5px; white-space: pre-wrap; }
        .success { background: #dff0d8; color: #3c763d; }
        .error { background: #f2dede; color: #a94442; }
        .info { background: #d9edf7; color: #31708f; }
    </style>
</head>
<body>
    <h2>Firebase Login Test</h2>
    <p>Project: ethiopian-maids</p>

    <input type="email" id="email" value="info@ethiopianmaids.com" placeholder="Email">
    <input type="password" id="password" value="231978@EthioAdmin" placeholder="Password">

    <button onclick="testLogin()">Test Login</button>
    <button class="secondary" onclick="resetPassword()">Send Password Reset Email</button>
    <button class="danger" onclick="updatePassword()">Update Password (if logged in)</button>

    <div id="result"></div>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "REMOVED_API_KEY",
            authDomain: "ethiopian-maids.firebaseapp.com",
            projectId: "ethiopian-maids",
            storageBucket: "ethiopian-maids.firebasestorage.app",
            messagingSenderId: "227663902586",
            appId: "1:227663902586:web:3d100f09f205d5833988c3"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();

        function showResult(message, type) {
            const result = document.getElementById('result');
            result.textContent = message;
            result.className = type;
        }

        async function testLogin() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            showResult('Testing login...', 'info');

            try {
                const userCredential = await auth.signInWithEmailAndPassword(email, password);
                const user = userCredential.user;
                showResult(
                    `SUCCESS! Login worked!\n\n` +
                    `User ID: ${user.uid}\n` +
                    `Email: ${user.email}\n` +
                    `Email Verified: ${user.emailVerified}\n` +
                    `Created: ${user.metadata.creationTime}\n` +
                    `Last Sign In: ${user.metadata.lastSignInTime}`,
                    'success'
                );
            } catch (error) {
                showResult(
                    `LOGIN FAILED\n\n` +
                    `Error Code: ${error.code}\n` +
                    `Message: ${error.message}\n\n` +
                    `This means the password in Firebase doesn't match.\n` +
                    `Click "Send Password Reset Email" to reset it.`,
                    'error'
                );
            }
        }

        async function resetPassword() {
            const email = document.getElementById('email').value;

            showResult('Sending password reset email...', 'info');

            try {
                await auth.sendPasswordResetEmail(email);
                showResult(
                    `PASSWORD RESET EMAIL SENT!\n\n` +
                    `Check your inbox at: ${email}\n\n` +
                    `After resetting your password, come back and test login again.`,
                    'success'
                );
            } catch (error) {
                showResult(`Error: ${error.code}\n${error.message}`, 'error');
            }
        }

        async function updatePassword() {
            const user = auth.currentUser;
            if (!user) {
                showResult('You must be logged in first to update password.', 'error');
                return;
            }

            const newPassword = document.getElementById('password').value;

            try {
                await user.updatePassword(newPassword);
                showResult(`Password updated successfully to: ${newPassword}`, 'success');
            } catch (error) {
                showResult(`Error: ${error.code}\n${error.message}`, 'error');
            }
        }

        // Check if already logged in
        auth.onAuthStateChanged((user) => {
            if (user) {
                showResult(`Already logged in as: ${user.email}`, 'info');
            }
        });
    </script>
</body>
</html>
